#!/bin/sh

# ================================================================
# JOBS
# ================================================================
# notify of bg job completion immediately
set -o notify

# ================================================================
# PROJECTS Workspace
# ================================================================
export PROJECTS_HOME=$HOME/projects

# ================================================================
# PATHS
# ================================================================
# we want the various sbins on the path along with /usr/local/bin
PATH="$PATH:/usr/local/sbin:/usr/sbin:/sbin"
PATH="/usr/local/bin:$PATH"

# put ~/bin on PATH if you have it
test -d "$HOME/bin" &&
PATH="$HOME/bin:$PATH"

# ================================================================
# ENVIRONMENT CONFIGURATION
# ================================================================
# detect interactive shell
case "$-" in
    *i*) INTERACTIVE=yes ;;
    *)   unset INTERACTIVE ;;
esac
# detect login shell
case "$0" in
    -*) LOGIN=yes ;;
    *)  unset LOGIN ;;
esac
# always use PASSIVE mode ftp
: ${FTP_PASSIVE:=1}
export FTP_PASSIVE

# ================================================================
# RVM, RBENV AND RUBY SETUP
# ================================================================
[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm"
PATH=$PATH:$HOME/.rvm/bin # Add RVM to PATH for scripting

[[ -n "$(command -v rbenv)" ]] && eval "$(rbenv init -)"

# history config
HISTCONTROL=ignoreboth
HISTFILESIZE=10000
HISTSIZE=10000

# ================================================================
# PAGER / EDITOR
# ================================================================
if [[ -n "$(command -v vim)" ]]; then
  export EDITOR=vim
  set -o vi
fi

if [[ -n "$(command -v less)" ]]; then
  PAGER="less -FirSwX"
  MANPAGER="less -FiRswX"
else
  PAGER=more
  MANPAGER="$PAGER"
fi
export PAGER MANPAGER

# ================================================================
# ACK
# ================================================================
ACK_PAGER="$PAGER"
ACK_PAGER_COLOR="$PAGER"

# ================================================================
# NODE SETUP
# ================================================================
if [[ -n "$(command -v npm)" ]]; then
  export NODE_PATH="/usr/local/lib/node_modules:$HOME/node_modules";
  PATH="$PATH:/usr/local/lib/node_modules/npm/bin:$HOME/node_modules/.bin";
  PATH="$PATH:/usr/local/share/npm/bin"
fi

# ================================================================
# GO SETTINGS
# ================================================================
if [[ -z $GOPATH ]]; then
  export GOPATH=$PROJECTS_HOME/gocode
  export PATH=$PATH:$PROJECTS_HOME/go/bin:$GOPATH/bin
fi

# ===============================================================
# SERVER UPTIME
# ===============================================================
if [[ -n "$INTERACTIVE" && -n "$LOGIN" ]]; then
  uname -npsr
  uptime
fi

# ================================================================
# LOAD LOCAL ENV
# ================================================================
[[ -f "$HOME"/.env ]] && source $HOME/.env

# ================================================================
# INITIALIZE boot2docker shell variables
# ================================================================

[[ -n "$(command -v boot2docker)" ]] && $(boot2docker shellinit 2> /dev/null)
